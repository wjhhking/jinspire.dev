---
layout: post
title: "å›¾è§£å¤§æ¨¡å‹ç”Ÿæˆè¿‡ç¨‹"
date: 2025-02-18
lang: zh
---

# æ³•å›½çš„é¦–éƒ½æ˜¯___

å½“å¤§æ¨¡å‹ç”Ÿæˆä¸€ä¸ªæ–°è¯æ—¶ï¼Œæ¨¡å‹å†…éƒ¨çš„çŸ©é˜µæ˜¯å¦‚ä½•å˜åŒ–çš„ï¼Ÿ

![attn_is_all_you_need]({{ '/assets/images/posts/attn_is_all_you_need.png' | relative_url }})

ä¸Šå›¾æ¥è‡ª"Attention is all you need"è®ºæ–‡ï¼Œéå¸¸ç›´è§‚åœ°å±•ç¤ºäº†transformerçš„è¿ä½œåŸç†ã€‚ä½†æ¨¡å‹å†…éƒ¨ç©¶ç«Ÿå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ

# çŸ©é˜µä¹˜æ³•

è®©æˆ‘ä»¬å…ˆçœ‹çœ‹çŸ©é˜µä¹˜æ³•ã€‚æ³¨æ„ä¸¤ä¸ªçŸ©é˜µçš„ç»´åº¦æ˜¯å¦‚ä½•åŒ¹é…çš„ï¼Œæˆ‘ä»¬å°†åœ¨ä¸‹é¢çš„å¯è§†åŒ–ä¸­ä½¿ç”¨è¿™ç§æ¨¡å¼ã€‚

![mat_mul]({{ '/assets/images/posts/mat_mul.png' | relative_url }})

è“è‰²ï¼šæ•°æ®ï¼ˆå¼ é‡ï¼‰
ç°è‰²ï¼šæ¨¡å‹æƒé‡

# åµŒå…¥å±‚

![embedding_layer]({{ '/assets/images/posts/embedding_layer.png' | relative_url }})

æˆ‘ä»¬ä»åµŒå…¥å±‚å¼€å§‹ã€‚å‡è®¾ä¸€ä¸ªè¯ç­‰äºä¸€ä¸ªtokenã€‚

è¾“å…¥å¥å­ï¼šæ³•å›½çš„é¦–éƒ½æ˜¯___

-> ['æ³•å›½', 'çš„', 'é¦–éƒ½', 'æ˜¯']

-> [2238, 295, 3361, 318]ï¼Œè¿™äº›æ˜¯å®ƒä»¬çš„Token ID

è¿™å½¢æˆäº†ä¸€ä¸ª[1, 4]å‘é‡ã€‚

æ•°æ®ç°åœ¨è¿›å…¥å¤§å°ä¸º[50,000, 768]çš„åµŒå…¥è¡¨è¿›è¡ŒæŸ¥æ‰¾ï¼š
- The     = [0.316, 0.524,0.063, 0.481, 0.266, â€¦]
- capital = [0.123, 0.234, 0.345, 0.456, 0.567, â€¦]
- of      = [0.432, 0.543, 0.654, 0.765, 0.876, â€¦]
- France  = [0.543, 0.654, 0.765, 0.876, 0.987, â€¦]
- is      = [0.654, 0.765, 0.876, 0.987, 0.098, â€¦]

-> è¿™æ ·æˆ‘ä»¬å¾—åˆ°äº†ä¸€ä¸ª[5, 768]çŸ©é˜µï¼

æˆ‘ä»¬å°†å…¶å¡«å……ï¼ˆé™„åŠ ä¸€äº›0ï¼‰åˆ°é•¿åº¦1024ï¼Œç°åœ¨å˜æˆäº†[1024, 768]ã€‚

# Transformerå—

![transformer_block]({{ '/assets/images/posts/transformer_block.png' | relative_url }})

æˆ‘ä»¬æœ‰ä¸‰ä¸ªå…³é”®çŸ©é˜µï¼šQã€Kã€Vã€‚æ¯ä¸ªéƒ½æ˜¯[768, 64] * 12ã€‚

å¯¹äºä¸€ä¸ªæ³¨æ„åŠ›å¤´ï¼Œ[1024, 768] * [768, 64] = [1024, 64]

Qçš„12ä¸ªå¤´ = [1024, 64] + [1024, 64] + ... + [1024, 64] = [1024, 12 * 64] = [1024, 768]

Kå’ŒVä¹Ÿæ˜¯ä¸€æ ·çš„ã€‚

K^T = [768, 1024]

QK^T = [1024, 1024]

Softmax(QK^T/âˆšd) = [1024, 1024]

Attn = Softmax(QK^T/âˆšd) * V = [1024, 768]

MLPæœ‰ä¸¤å±‚ï¼šä¸€å±‚ä½¿ç”¨[768 Ã— 3072]æ‰©å±•4å€ï¼Œä¸€å±‚ä½¿ç”¨[3072 Ã— 768]æ”¶ç¼©

å˜åŒ–ï¼š[1024, 768] -> [1024, 3072] -> [1024, 768]

# æ•´ä¸ªè¿‡ç¨‹

![transformer_tensors]({{ '/assets/images/posts/transformer_tensors.png' | relative_url }})

æˆ‘ä»¬æå–æœ€åä¸€è¡Œï¼š[768]

ç„¶åï¼Œæˆ‘ä»¬ä½¿ç”¨åŸå§‹çš„åµŒå…¥è¡¨[50,000, 768]æ˜ å°„å›Token IDï¼Œå¾—åˆ°æœ€ç»ˆçš„è¯ï¼šParis

# æ¨¡å‹å‚æ•°

æ‰€æœ‰çš„transformeræ¨¡å‹éƒ½æœ‰ç±»ä¼¼çš„ç»“æ„ï¼Œåªæ˜¯å±‚æ•°(12)ã€d_model(768)ã€d_head(64)ç­‰å‚æ•°ä¸åŒã€‚é™„å½•å±•ç¤ºäº†è‘—åæ¨¡å‹çš„å‚æ•°æ•°é‡ã€‚æœ€æ–°çš„ç ”ç©¶è‡´åŠ›äºä½¿ç”¨ä¸åŒçš„æ³¨æ„åŠ›æœºåˆ¶ï¼ˆå¦‚MLAã€NSAï¼‰æ¥å‡å°‘å‚æ•°æ€»æ•°ï¼Œè¿™ä¸æ˜¯æœ¬æ–‡çš„é‡ç‚¹ã€‚

æ„Ÿè°¢é˜…è¯»ï¼ğŸ‰ ğŸ¥° ğŸ«¡

# é™„å½•ï¼šå‚æ•°æ•°é‡

æ³¨æ„ï¼šä»¥ä¸‹å‚æ•°æ˜¯ç”±AIè¾…åŠ©ç”Ÿæˆï¼Œå°šæœªç»è¿‡ä»”ç»†çš„äººå·¥éªŒè¯ã€‚

### Llamaç³»åˆ—
![llama_parameters]({{ '/assets/images/posts/llama_parameters.png' | relative_url }})

### Qwenç³»åˆ—
![qwen_parameters]({{ '/assets/images/posts/qwen_parameters.png' | relative_url }})

### DeepSeekç³»åˆ—
![deepseek_parameters]({{ '/assets/images/posts/deepseek_parameters.png' | relative_url }})

### ChatGPTç³»åˆ—
![chatgpt_parameters]({{ '/assets/images/posts/chatgpt_parameters.png' | relative_url }})

### å…¶ä»–
é‰´äºClaudeå’ŒGeminiæ˜¯é—­æºçš„ï¼Œä»…å±•ç¤ºå¯¹å…¶å‚æ•°çš„çŒœæµ‹å¹¶æ²¡æœ‰å¤ªå¤§ä»·å€¼ã€‚åŒæ ·åœ°ï¼Œå¯¹äºåˆšåˆšå‘å¸ƒçš„Grok-3ï¼Œè®©æˆ‘ä»¬æ‹­ç›®ä»¥å¾…ï¼

